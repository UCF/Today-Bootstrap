# UCF Today WordPress theme - [News and Stories from the University of Central Florida and Orlando](http://today.ucf.edu)

Theme to replace the original Today WordPress theme, which relies on the Thematic framework. Written from the UCF Generic Bootstrap theme.



## Installation

### Required Plugins:
* Social
* Twitter Tools (requires Social)
* UCF Social Plugin
* Varnish Dependency Purger
* WP-Print

### Required Installation Settings:
* Network > Settings > Network Settings: Make sure the 'Site upload space' checkbox is unchecked. (Set this BEFORE importing content!)
* Settings > Permalinks: set Category base to 'section'; set Tag base to 'topic'; make sure posts use the 'post name' permalink structure.
* Update pages with old Blueprint markup to use Bootstrap markup, or remove those pages entirely
* Settings > Discussion: Make sure Trackbacks/Pingbacks are DISABLED.
* When behind Varnish, make sure to update the the Dependency Purger Varnish nodes list and turn on ESIs in Theme Options > Site.

### Installation Recommendations:
* Update all post types to remove Pingback functionality. A lot of posts were originally created with the Pingback functionality turned on, and unfortunately they are still capable of receiving spam. Pingback functionality for posts/pages can be disabled through the WordPress interface in bulk; modify your default number of displayed posts in the Posts admin area, select all, then Bulk Edit the 'Pings' value to 'do not allow'. (http://wordpress.stackexchange.com/questions/84633/how-to-disable-wordpress-trackback)
The primary issue with Pingbacks, though, is that media attachments allow them, and there isn't an option in the WordPress admin interface to disable them on existing attachments. To actually disable Pingbacks on every post type, a SQL statement will need to be run against the database directly: `UPDATE wp_posts SET ping_status="closed";` (note: wp_posts will be named 'wp_SITEID_posts' on multisite installs.)
* Disable comments on all attachments. The theme comes with this built-in, but only for future attachments. Use the SQL statement `UPDATE wp_posts SET comment_status="closed" WHERE post_type="attachment";` to remove commenting on all existing attachments (note: wp_posts will be named 'wp_SITEID_posts' on multisite installs.)


## Configuration
* Create a menu named 'Top Navigation' with the appropriate navigation links.
* Create a menu for the social media buttons and assign this menu to the 'Social Links' display location.
* Ensure that the homepage display option is set to 'Your latest posts' in Reading Settings.


## Development

Note that compiled, minified css and js files are included within the repo. Changes to these files should be tracked via git (so that users installing the theme using traditional installation methods will have a working theme out-of-the-box.)

### Requirements
* node
* gulp

### Instructions
1. Clone the Today-Bootstrap repo into your development environment, within your WordPress installation's `themes/` directory: `git clone https://github.com/UCF/Today-Bootstrap.git`
2. `cd` into the Today-Bootstrap directory, and run `npm install` to install required packages for development into `node_modules/` within the repo
3. Duplicate `gulp-config.template.json`, make any desired changes, and save as `gulp-config.json`.
3. Run `gulp default` to process front-end assets.
4. If you haven't already done so, create a new WordPress site on your development environment, install the required plugins listed above, and set the 'UCF Today WordPress Theme Bootstrap' as the active theme.
5. Make sure you've done all the steps listed under "Configuration" above.
6. Run `gulp watch` to continuously watch changes to scss and js files.  If you enabled BrowserSync in `gulp-config.json`, it will also reload your browser when scss or js files change.

### Importing Data
Today tends to export HUGE XML files which don't import well-- use a WXR splitter (http://github.com/suhastech/Wordpress-WXR-Splitter/) to generate smaller chunks of data for import.


## Custom Post Types
* Alert (Header)
* Post (Extends base post type)
* Expert
* Photoset
* Video
* Profile
* External Story

Note: the Update post type was not carried over from the original theme.


## Custom Taxonomies
* Experts (for Post, Photoset CPTs)
* Groups (for Profile CPT)


## Shortcodes
This theme carries over the 'post-type-search' and 'search_form' shortcodes from Generic Theme. Note that no CPTs in this theme use the autogenerated 'posttype-list' shortcode.

Every shortcode custom to this theme takes a `css` attribute that allows the user to specify CSS classes that should be applied to the shortcode's wrapper div.
Other attributes are listed below the given shortcode's name, if available.

### Posts (lists)
* feature
* ucf_news
	* social (0,1...default:1) - Display social network buttons
	* header (0,1...default:1) - Display the More headlines header
	* num_post (number...default:3) - How many headlines should be displayed
* more_headlines
	* social (0,1...default:1) - Display social network buttons
	* header (0,1...default:1) - Display the More headlines header
	* num_post (number...default:3) - How many headlines should be displayed
	* offset (number...default:3) - Offset to retrieve more headlines
* subpage_features
* promos

### Posts (single)
* single_post
* single_post_meta
* single_post_more_tag
* single_post_more_cat
* single_post_comments
* single_post_topics
* single_post_recommended
* single_post_related_experts

### Photos
* ucf_photo
	* link_page_name (string...default:"Photos") - Determines the text of the header and name of the page the More link will go to.

### Photo Sets
* photo_set
* photo_sets

### Videos
* ucf_video
	* height(number) - Height of the embed. If left blank, will be autosized based on width
	* width(number...default:400) - Width of the embed
* videos

### Feeds
* events
* announcements

### Experts
* expert_short
* expert_meta
* expert_tagged
* expert_videos
* expert_photos

### External Stories
* external_stories

### Profiles
* profile

### Other
* myucf_signon


## Styling
Most utility CSS classes have been carried over from the old Today theme, and are listed below.
Border-related classes can be added anywhere, but are intended for use on .span divs.

Note that the `checkered` CSS class has been removed in favor of Bootstrap's `table-striped` class.

* .border-both: Add vertical borders to the left and right of a div.
* .border-left
* .border-right
* .border-top
* .border-bottom
* .orange: Adds orange color to text.
* .cropped: Should be added to a `.thumb` element to proportionally stretch a thumbnail to a confined space. Elements with this class should have a background image specified, an explicit `height` value (in pixels), as well as a child image (with the same URL) contained within an `<a>` tag. Thumbnails with the .cropped style will adjust to best fit the designated space, despite the actual thumbnail's dimensions.


## Other Notes

* The video_carousel shortcode was removed from the previous version of the theme.
* Bootstrap responsive styles were readded to the theme as of v2.1.7.  Note, however, that they (and style-responsive.css) are only loaded on single story templates and on the search result template.  No other templates utilize responsive styles.
* New template functionality has been added to this theme: any post/CPT or taxonomy that previously relied on a page with markup/shortcodes for its content will now fall back to a default template if no content or page is provided. (Category, Tag, Expert, Home, Photo Set, Single, Tag, Video ** NOT 'Videos' **)
* Note that comments are NOT handled by the Varnish Dependency Purge plugin-- approved comments will appear when their story's cache has expired.
